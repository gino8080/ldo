# ISTRUZIONI VALIDAZIONE

## Installare il certificato sul computer

1. scaricae il file **auth_magico.p12**
2. fare doppio click per installarlo e inserire la password fornita separataemnte

## Lanciare il browser in modalità SENZA SICUREZZA

Questo step è necessario per evitare gli errori di CORS

### Per PC Windows:

Chiudi il browser Chrome e poi apri la finestra dei comandi (quella dos per intenderci, per chi ha qualche capello bianco) e posizionati all'interno della cartella in cui è stato installato chrome. Se non riesci a trovare, clicca con il pulsante destro sopra l'icona di lancio del browser e accedi a Proprietà>Collegamenti.

Dopo digita, facendo attenzione agli spazi, la seguente scritta per lanciare il browser:

`chrome.exe --disable-web-security`

### Per MAC:

Chiudi il browser Chrome e apri la finestra terminale, inserendo la stringa:

```bash
$ open -a Google\ Chrome --args --disable-web-security
```

## Step preliminari

1. Collegarsi al sito https://github.com/ministero-salute/it-fse-support/blob/main/openapi/gateway/swagger_gtw.yaml e copiare il contenuto del file
2. Collegarsi al sito https://editor.swagger.io/ ed incollare il contenuto del file yaml nella parte a sinistra cancellando prima evenutali altri comandi
3. Su https://editor.swagger.io/ cliccare sul bottone verde col lucchetto **Authorize**

4. Incollare questa stringa Bearer nella prima casella di insert

   ```
   eyJ4NWMiOlsiTUlJRmFUQ0NBMUdnQXdJQkFnSVVDcnNZd3BUYmhUOTRsL3Z3dEw1YlRxcEQveXN3RFFZSktvWklodmNOQVFFTEJRQXdWekVuTUNVR0ExVUVBd3dlUTBFZ1RXbHVhWE4wWlhKdklHUmxiR3hoSUZOaGJIVjBaU0JVWlhOME1SOHdIUVlEVlFRS0RCWk5hVzVwYzNSbGNtOGdaR1ZzYkdFZ1UyRnNkWFJsTVFzd0NRWURWUVFHRXdKSlZEQWVGdzB5TXpBMk1UWXhNalEzTUROYUZ3MHlOakEyTVRZeE1qUTNNREphTUdveEN6QUpCZ05WQkFZVEFrbFVNUjh3SFFZRFZRUUtEQlpOYVc1cGMzUmxjbThnWkdWc2JHRWdVMkZzZFhSbE1SOHdIUVlEVlFSaERCWkRSanBKVkMxUVVrOVdRVmd3TUZnd01GZ3dNREJaTVJrd0Z3WURWUVFEREJCVE1TTXhNVEZUU1ZNMFEwRlNSVmhZTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUFvUGJSK05tZTBsN2xyazJyTzRRblltbmxLQitVb2t4NW91ZVFTRFExYm9mRFluWFNVL3VGSU4zNVFrb3hUNGZyUTh1WDhMUmsrRjdMdXhQQzU4SmlwVHE1aUpWYzVIa2RJbkR2OEJQZkNDR00wN3ZzT3A0VWdQVWZoMWNCRndtRmljMytweXpPR01qdmI4WEdqMzdXRStabW9ua1oyQ1ZNTlhrWDFJNnpmSVhxMTd3RFYzN1dKMHFWRmdrbS9Ucm82R3FiNitqdVdMdXo3QUZMUWVzVU5kWjJTQjZ2SHB0YW1QZmJFdzExNkpjUHAxRkJEaThlbUEybTRvdkRuK0NIMnpxZDYzamR1K0FFbjJiSFdaKys2VUorNUhLbForc2dTbGlqTkZqN1E5OG1RS2Joci9naG1LZUt4OUFaaXQ1bDZnekNMZmxhMEZNelExNHFLOXZ3SlFJREFRQUJvNElCR0RDQ0FSUXdId1lEVlIwakJCZ3dGb0FVRmptcEdnV0p0dzh0c2pYdHdnbWF4UU9ESWo4d0VnWURWUjBnQkFzd0NUQUhCZ1VyVEIwQkN6Q0JyUVlEVlIwZkJJR2xNSUdpTUlHZm9JR2NvSUdaaG9HV2FIUjBjSE02THk5allYTnZaMlZwYzNacGJDNXpiMmRsYVM1cGRDOWxhbUpqWVM5d2RXSnNhV04zWldJdmQyVmlaR2x6ZEM5alpYSjBaR2x6ZEQ5amJXUTlZM0pzSm1semMzVmxjajFEVGlVelJFTkJLMDFwYm1semRHVnlieXRrWld4c1lTdFRZV3gxZEdVclZHVnpkQ1V5UTA4bE0wUk5hVzVwYzNSbGNtOHJaR1ZzYkdFclUyRnNkWFJsSlRKRFF5VXpSRWxVTUIwR0ExVWREZ1FXQkJUMS8yVGgyL2kzSzJsY0xPYWZ2cWxMbVBTMnFEQU9CZ05WSFE4QkFmOEVCQU1DQmtBd0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dJQkFEZGg2ZEFScDBGMWZtMDl3M1JHQ3M1dGRXZnVBQ2Y0ZEtUay9yZkR1bmhhcDNzdyt6TE9LOC9Za09vVXluUkdFZFhtQWxpT2swQy9oQ1duTkpxYUR2TGJWN3U5Q2V6Tzc5N2cwL0F2Sml2MHl1SUcySTB3MjRPd01NWUgxa29ZdmRxYkkyWExOQ0U2Y2hvQlFFS1F2V3hzQTNNeGt1bjFvVm5QdGltSGdCaXRDMXJNK1J5cnZXemRySFNRMG1HSm5HdlRLMFYxcWNrY3oxSlRhUGZqU3VCNFV3Mm9zZk5zVGI1WU54SE4rOGx3b1dtc01INnQzQjhIVHdqRjdRSGtSTlZOWDFWTUptYWlFZVFqYndyRzlRNkh0ZFZST0gwaXk4a1BoUWZqNklZYUtwdTk4UHEzUTVrUGxydHREMmtQOUV0QkIvV3VpaUFsc1AvYlhwV1F4aUE0UVJKN2dhTTJyT3lyMnpINlBLRkwyRzZkbTVvd2xpdEZkdmhRUm45NjRhQ0tGYlBKZjRIQzU0OTExeXlZRzJtcDZyN1JzS1FZMWN6UnRvLzhjdmdoVThPWEFaRXh5Sjl4QitmcnArWStrYXl1azZQNFNGNEtHcUQwUkRIOXZBRG5LcHRBa3pVZXM4eERVanJxZWJHWW1vWXhKTE9Fa05mRDZpSUhIWGQreWdDMlFDOUxzMkFEUzBBNVNlNFJXeko4TlA4U3RDemJVYVY1OVZycXl1emJOdjJQTytlTWtiRE5KRXR2QmMybUlDa0x1VUJTemY5NDU1cStuN1pkYmhubUlNQmtwMENqVUhFcEtvckp0OGhvbDdTTlV1ejZXdCtXOEZvR0NIMVpOcGZCUDczODZWbTdzc2wzWjh0dUhmS2IxWXZZY05jODdnQmpmMzMxaFgzbSJdLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJHUkNTRk44N0IxMkg1MDFEXl5eJjIuMTYuODQwLjEuMTEzODgzLjIuOS40LjMuMiZJU08iLCJhdWQiOiJodHRwczovL21vZGlwYS12YWwuZnNlLnNhbHV0ZS5nb3YuaXQvZ292d2F5L3Jlc3QvaW4vRlNFL2dhdGV3YXkvdjEiLCJpc3MiOiJhdXRoOlMxIzExMVNJUzRDQVJFWFgiLCJleHAiOjE2ODk5NTYyNDEsImlhdCI6MTY4OTg2OTg0MSwianRpIjoiYzMwNzk1ZWU5ZDdkNDlhNGIyYzU0NTllMTVlMjA2NjUifQ.EjQnboazsR4qODHtFFCn3HjiaaP9qtO39XouRfLHPxszhDqpvoCePytEnNwCR4vzFrhEC4gWd9Gc-Q4N6pDTJyeV1Ga44vmXPr44eVGzWqn2J_ty7Grc_3LlTFck2nKGW2ci4NYn_kUrONG2s4VbLls8gWihRI8qdxkgUeHLeRj5X4H1I9jwhEvlJcp-FDsnuJNunAT8rJRal7H9afvsEaEro-uLIoFHYHud_JZjHpkfsiWBq8ww4N8sa6H341xLGFaMq1Q71qFax0SjMr3VpNomeDOVi0KEqcEqCh4i34PVLTIQ6ac57SHXAfbrXSH69WoN5n6MaLa3g3jhQiQQ0g
   ```

   e cliccare sul bottone **Authorize**

5. incollare questa stringa nel secondo campo

   ```
   eyJ4NWMiOlsiTUlJRmFUQ0NBMUdnQXdJQkFnSVVDcnNZd3BUYmhUOTRsL3Z3dEw1YlRxcEQveXN3RFFZSktvWklodmNOQVFFTEJRQXdWekVuTUNVR0ExVUVBd3dlUTBFZ1RXbHVhWE4wWlhKdklHUmxiR3hoSUZOaGJIVjBaU0JVWlhOME1SOHdIUVlEVlFRS0RCWk5hVzVwYzNSbGNtOGdaR1ZzYkdFZ1UyRnNkWFJsTVFzd0NRWURWUVFHRXdKSlZEQWVGdzB5TXpBMk1UWXhNalEzTUROYUZ3MHlOakEyTVRZeE1qUTNNREphTUdveEN6QUpCZ05WQkFZVEFrbFVNUjh3SFFZRFZRUUtEQlpOYVc1cGMzUmxjbThnWkdWc2JHRWdVMkZzZFhSbE1SOHdIUVlEVlFSaERCWkRSanBKVkMxUVVrOVdRVmd3TUZnd01GZ3dNREJaTVJrd0Z3WURWUVFEREJCVE1TTXhNVEZUU1ZNMFEwRlNSVmhZTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUFvUGJSK05tZTBsN2xyazJyTzRRblltbmxLQitVb2t4NW91ZVFTRFExYm9mRFluWFNVL3VGSU4zNVFrb3hUNGZyUTh1WDhMUmsrRjdMdXhQQzU4SmlwVHE1aUpWYzVIa2RJbkR2OEJQZkNDR00wN3ZzT3A0VWdQVWZoMWNCRndtRmljMytweXpPR01qdmI4WEdqMzdXRStabW9ua1oyQ1ZNTlhrWDFJNnpmSVhxMTd3RFYzN1dKMHFWRmdrbS9Ucm82R3FiNitqdVdMdXo3QUZMUWVzVU5kWjJTQjZ2SHB0YW1QZmJFdzExNkpjUHAxRkJEaThlbUEybTRvdkRuK0NIMnpxZDYzamR1K0FFbjJiSFdaKys2VUorNUhLbForc2dTbGlqTkZqN1E5OG1RS2Joci9naG1LZUt4OUFaaXQ1bDZnekNMZmxhMEZNelExNHFLOXZ3SlFJREFRQUJvNElCR0RDQ0FSUXdId1lEVlIwakJCZ3dGb0FVRmptcEdnV0p0dzh0c2pYdHdnbWF4UU9ESWo4d0VnWURWUjBnQkFzd0NUQUhCZ1VyVEIwQkN6Q0JyUVlEVlIwZkJJR2xNSUdpTUlHZm9JR2NvSUdaaG9HV2FIUjBjSE02THk5allYTnZaMlZwYzNacGJDNXpiMmRsYVM1cGRDOWxhbUpqWVM5d2RXSnNhV04zWldJdmQyVmlaR2x6ZEM5alpYSjBaR2x6ZEQ5amJXUTlZM0pzSm1semMzVmxjajFEVGlVelJFTkJLMDFwYm1semRHVnlieXRrWld4c1lTdFRZV3gxZEdVclZHVnpkQ1V5UTA4bE0wUk5hVzVwYzNSbGNtOHJaR1ZzYkdFclUyRnNkWFJsSlRKRFF5VXpSRWxVTUIwR0ExVWREZ1FXQkJUMS8yVGgyL2kzSzJsY0xPYWZ2cWxMbVBTMnFEQU9CZ05WSFE4QkFmOEVCQU1DQmtBd0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dJQkFEZGg2ZEFScDBGMWZtMDl3M1JHQ3M1dGRXZnVBQ2Y0ZEtUay9yZkR1bmhhcDNzdyt6TE9LOC9Za09vVXluUkdFZFhtQWxpT2swQy9oQ1duTkpxYUR2TGJWN3U5Q2V6Tzc5N2cwL0F2Sml2MHl1SUcySTB3MjRPd01NWUgxa29ZdmRxYkkyWExOQ0U2Y2hvQlFFS1F2V3hzQTNNeGt1bjFvVm5QdGltSGdCaXRDMXJNK1J5cnZXemRySFNRMG1HSm5HdlRLMFYxcWNrY3oxSlRhUGZqU3VCNFV3Mm9zZk5zVGI1WU54SE4rOGx3b1dtc01INnQzQjhIVHdqRjdRSGtSTlZOWDFWTUptYWlFZVFqYndyRzlRNkh0ZFZST0gwaXk4a1BoUWZqNklZYUtwdTk4UHEzUTVrUGxydHREMmtQOUV0QkIvV3VpaUFsc1AvYlhwV1F4aUE0UVJKN2dhTTJyT3lyMnpINlBLRkwyRzZkbTVvd2xpdEZkdmhRUm45NjRhQ0tGYlBKZjRIQzU0OTExeXlZRzJtcDZyN1JzS1FZMWN6UnRvLzhjdmdoVThPWEFaRXh5Sjl4QitmcnArWStrYXl1azZQNFNGNEtHcUQwUkRIOXZBRG5LcHRBa3pVZXM4eERVanJxZWJHWW1vWXhKTE9Fa05mRDZpSUhIWGQreWdDMlFDOUxzMkFEUzBBNVNlNFJXeko4TlA4U3RDemJVYVY1OVZycXl1emJOdjJQTytlTWtiRE5KRXR2QmMybUlDa0x1VUJTemY5NDU1cStuN1pkYmhubUlNQmtwMENqVUhFcEtvckp0OGhvbDdTTlV1ejZXdCtXOEZvR0NIMVpOcGZCUDczODZWbTdzc2wzWjh0dUhmS2IxWXZZY05jODdnQmpmMzMxaFgzbSJdLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJHUkNTRk44N0IxMkg1MDFEXl5eJjIuMTYuODQwLjEuMTEzODgzLjIuOS40LjMuMiZJU08iLCJzdWJqZWN0X3JvbGUiOiJBQVMiLCJwdXJwb3NlX29mX3VzZSI6IlRSRUFUTUVOVCIsImlzcyI6ImludGVncml0eTpTMSMxMTFTSVM0Q0FSRVhYIiwibG9jYWxpdHkiOiIxMjAyMDUiLCJzdWJqZWN0X2FwcGxpY2F0aW9uX3ZlcnNpb24iOiJWLjEuMC4wIiwic3ViamVjdF9vcmdhbml6YXRpb24iOiJSZWdpb25lIExhemlvIiwic3ViamVjdF9vcmdhbml6YXRpb25faWQiOiIxMjAiLCJhdWQiOiJodHRwczovL21vZGlwYS12YWwuZnNlLnNhbHV0ZS5nb3YuaXQvZ292d2F5L3Jlc3QvaW4vRlNFL2dhdGV3YXkvdjEiLCJwYXRpZW50X2NvbnNlbnQiOnRydWUsImFjdGlvbl9pZCI6IkNSRUFURSIsInJlc291cmNlX2hsN190eXBlIjoiKCczNDEwNS03Xl4yLjE2Ljg0MC4xLjExMzg4My42LjEnKSIsImF0dGFjaG1lbnRfaGFzaCI6IjFlYTRmZmU5YjJkMTA4NGE3YzMxZjdiOTk4ZmNhMDQ4OTA5NTViYzAzNGQ0NWRlMzY2N2ZjY2YzMzMzZDkwMWIiLCJzdWJqZWN0X2FwcGxpY2F0aW9uX2lkIjoiU0lTNENBUkUiLCJleHAiOjE2ODk5NTYyNDEsInN1YmplY3RfYXBwbGljYXRpb25fdmVuZG9yIjoiUE9MSVMtTkVUIFNSTCIsImlhdCI6MTY4OTg2OTg0MSwianRpIjoiYzMwNzk1ZWU5ZDdkNDlhNGIyYzU0NTllMTVlMjA2NjUiLCJwZXJzb25faWQiOiJNWlpHU1AyMkUyM0g1MDFIXl5eJmFtcDsyLjE2Ljg0MC4xLjExMzg4My4yLjkuNC4zLjImYW1wO0lTTyJ9.gnG6mdz62dMH9VswSXzpljGEjvG9_2UIxoTmTKOtrv3LMD2Y1D1wORLm6ZbRsNwB4LZxQF61DlgZENgeomuJHtqqmCCjrqHTXzfg9SaPZy7EQWYFUHX4if2hWK39RaKOxltmrsb7iTvGyLmfUdFLSXFSwt_2Y3n4FHTekLTA7xjlKqUv5iLRO6OqFjBoBuaOixgVuEd7aaRzIDWVS5WYDZYMNQcc8XES1CfIR45eRd7IDhykr5bxNobJb3j91tWf6HBAD9X6l7Wbe8Z-f_Md3ZkH9IcOa9cY2wir9Gk0JLkcEigoVhw4JOVxJsQEGWRk6faJZ_1MzBNFKNNop63u_A
   ```

   e cliccare sul bottone **Authorize**

6. Chiudere la modale cliccando sulla x

## VALIDAZIONE CDA

1. cliccare sulla riga Verde POST /documents/validation
   Validazione documenti per aprirla
2. cliccare sul bottone **Try it out**
3. nel primo campo requestBody sostiuire il json con questo

```json
{
  "healthDataFormat": "CDA",
  "mode": "ATTACHMENT",
  "activity": "VALIDATION"
}
```

4. nel campo **file** caricare il file **ldo_xml.pdf**
5. cliccare il tasto blue **Execute** per inviare la richiesta
6. Quando richiesto selezionare il certificato col nome **A1#111SIS4CAREXX**
7. più sotto nella response il code dovrebbe essere **201** e la resaponseBody indficare i dettagli (potrebbero essere presenti dei warning)

## CARICAMENTO DOCUMENTO FIRMATO

1. Cliccare su POST /documents Pubblicazione creazione documenti
2. Cliccare su Try it out
3. Incollare il seguente json nella requestBody
   ```json
   {
     "healthDataFormat": "CDA",
     "mode": "ATTACHMENT",
     "tipologiaStruttura": "Ospedale",
     "identificativoDoc": "2.16.840.1.113883.2.9.2.120.4.4^290700",
     "identificativoRep": " 2.16.840.1.113883.2.9.2.120.4.5.1",
     "tipoDocumentoLivAlto": "LDO",
     "assettoOrganizzativo": "AD_PSC001",
     "tipoAttivitaClinica": "CON",
     "identificativoSottomissione": "2.16.840.1.113883.2.9.2.120.4.3.489592",
     "priorita": false,
     "administrativeRequest": "SSN"
   }
   ```
4. nel campo **file** caricare il file **ldo_xml.pdf**
5. Cliccare su Execute
6. Se tutto va a buon fine si ottiene risposta "STATUS 201"
